version: '3.1'

stories:
# check user login utter_anything_else_v2 vs rule utter_anything_else ändern
  - story: check login happy + start recommender
    steps:
    - intent: start_recommender_form
    - action: action_delete_slot_value
    - slot_was_set:
      - user_login: true
    - action: utter_affirm_start_recommender_form #v2 erstellen: Für die Kurssuche werde ich dir ein paar Fragen stellen. Wollen wir die Kurssuche starten?
    - intent: affirm
    - action: action_fetch_profile
    - slot_was_set:
      - enrollments: "Einführung in die KI"
      - course_visits: "Big Data Analytics"
      - search_terms: "KI"
    - checkpoint: start_recommender_form

  - story: check login happy + no recommender
    steps:
    - intent: start_recommender_form
    - action: action_delete_slot_value
    - slot_was_set:
      - user_login: true
    - action: utter_affirm_start_recommender_form # v2 erstellen
    - intent: deny
    - action: utter_anything_else_v2

  - story: check login unhappy + start recommender
    steps:
    - intent: start_recommender_form
    - action: action_delete_slot_value
    - slot_was_set:
      - user_login: false
    - action: utter_tip_login
    - action: utter_affirm_start_recommender_form_login # v1
    - intent: affirm
    - checkpoint: start_recommender_form

  - story: check login unhappy + no courseseach
    steps:
    - intent: start_recommender_form
    - action: action_delete_slot_value
    - slot_was_set:
      - user_login: false
    - action: utter_tip_login
    - action: utter_affirm_start_recommender_form_login #v1
    - intent: deny
    - action: utter_anything_else_v2

# recommender form
  - story: activate course form
    steps:
    - checkpoint: start_recommender_form
    - action: recommender_form      
    - active_loop: recommender_form 

# recommender form variations
  - story: languages interjection
    steps:
    - checkpoint: start_recommender_form
    - action: recommender_form
    - active_loop: recommender_form
    - intent: interjection_languages
    - action: utter_interjection_languages
    - action: recommender_form

  - story: time interjection
    steps:
    - checkpoint: start_recommender_form
    - action: recommender_form
    - active_loop: recommender_form
    - intent: interjection_time
    - action: utter_interjection_time
    - action: recommender_form

  - story: costs interjection
    steps:
    - checkpoint: start_recommender_form
    - action: recommender_form
    - active_loop: recommender_form
    - intent: interjection_costs
    - action: utter_interjection_costs
    - action: recommender_form

  - story: topic interjection
    steps:
    - checkpoint: start_recommender_form
    - action: recommender_form
    - active_loop: recommender_form
    - intent: interjection_topic
    - action: utter_interjection_topic
    - action: recommender_form

## KONFLIKT MIT KIC FAQ?
  - story: faq interjection
    steps:
    - checkpoint: start_recommender_form
    - action: recommender_form
    - active_loop: recommender_form
    - intent: faq
    - action: utter_faq
    - action: recommender_form

  - story: stop recommender form happy
    steps:
    - checkpoint: start_recommender_form 
    - action: recommender_form    
    - active_loop: recommender_form
    - intent: stop_form
    - action: utter_ask_continue_recommender_form
    - intent: affirm
    - action: action_deactivate_loop
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: utter_bot_information
    - intent: goodbye
    - action: utter_goodbye

  - story: stop recommender form happy 2
    steps:
    - checkpoint: start_recommender_form 
    - action: recommender_form    
    - active_loop: recommender_form
    - intent: stop_form
    - action: utter_ask_continue_recommender_form
    - intent: affirm
    - action: action_deactivate_loop
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: utter_bot_information
    - intent: faq
    - action: utter_faq
    - action: utter_anything_else

  - story: stop recommender form unhappy
    steps:
    - checkpoint: start_recommender_form 
    - action: recommender_form    
    - active_loop: recommender_form
    - intent: stop_form
    - action: utter_ask_continue_recommender_form
    - intent: deny
    - action: recommender_form

  - story: negative feedback reaction
    steps:
    - intent: negative_feedback 
    - action: utter_bot_apology
    - action: utter_anything_else
    - checkpoint: more_information

# change course search parameter
  - story: get more learning recommendation
    steps:
    - intent: additional_learning_recommendation
    - action: action_additional_learning_recommendation
    - action: utter_anything_else_v2

  - story: change language learning recommendation
    steps:
    - intent: change_language_slot
    - action: action_delete_slot_value
    - action: recommender_form      
    - active_loop: recommender_form 

  - story: change topic learning recommendation
    steps:
    - intent: change_topic_slot
    - action: action_delete_slot_value
    - action: recommender_form      
    - active_loop: recommender_form 

  - story: change level learning recommendation
    steps:
    - intent: change_level_slot
    - action: action_delete_slot_value
    - action: recommender_form      
    - active_loop: recommender_form 

  - story: change max_duration learning recommendation
    steps:
    - intent: change_max_duration_slot
    - action: action_delete_slot_value
    - action: recommender_form      
    - active_loop: recommender_form 

  - story: change certificate learning recommendation
    steps:
    - intent: change_certificate_slot
    - action: action_delete_slot_value
    - action: recommender_form      
    - active_loop: recommender_form 